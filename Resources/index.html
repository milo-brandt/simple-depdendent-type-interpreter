<!DOCTYPE html>
<html>
<body>
<input type="number" id="value" name="value" min="1" max="40" step="1" value="17">
<button onclick="add()">Add</button>
<button onclick="reset()">Reset</button>
<button onclick="bad()">Bad</button>
<p id="output">Press a button...</p>

<script>
function update(data) {
  if(data.ok) {
    document.getElementById("output").innerHTML = "Value is: " + data.value;
  } else {
    document.getElementById("output").innerHTML = data.error;
  }
}
function update_error(reason) {
  document.getElementById("output").innerHTML = reason;
}

function add() {
  var v = Number(document.getElementById("value").value);
  fetch('/query', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      action: "add",
      amount: v
    })
  }).then(response => response.json()).then(update).catch(update_error);
}
function reset() {
  fetch('/query', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      action: "reset"
    })
  }).then(response => response.json()).then(update).catch(update_error);
}
function bad() {
  fetch('/query', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      action: "woot"
    })
  }).then(response => response.json()).then(update).catch(update_error);
}

</script>
</body>
</html>
